{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/kushagraverma/Desktop/Neural%20Pulse/Oriondiamonds/src/utils/shopify.js"],"sourcesContent":["export const SHOPIFY_STORE_DOMAIN =\n  process.env.NEXT_PUBLIC_SHOPIFY_STORE_DOMAIN;\nexport const STOREFRONT_ACCESS_TOKEN =\n  process.env.NEXT_PUBLIC_SHOPIFY_STOREFRONT_TOKEN;\nexport const STOREFRONT_API_URL = `https://${SHOPIFY_STORE_DOMAIN}/api/2024-01/graphql.json`;\n\n// Validation\nif (!SHOPIFY_STORE_DOMAIN || !STOREFRONT_ACCESS_TOKEN) {\n  console.error(\n    \"⚠️ Missing Shopify environment variables! Check your .env file.\"\n  );\n}\n\n// Shopify Storefront API request function\nexport async function shopifyRequest(query, variables = {}) {\n  try {\n    const response = await fetch(STOREFRONT_API_URL, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-Shopify-Storefront-Access-Token\": STOREFRONT_ACCESS_TOKEN,\n      },\n      body: JSON.stringify({\n        query,\n        variables,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\n        `Shopify API error: ${response.status} ${response.statusText}`\n      );\n    }\n\n    const json = await response.json();\n\n    if (json.errors) {\n      console.error(\"GraphQL Errors:\", json.errors);\n      throw new Error(json.errors[0].message);\n    }\n\n    return json;\n  } catch (error) {\n    console.error(\"Error making Shopify request:\", error);\n    throw error;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAO,MAAM;AAEN,MAAM;AAEN,MAAM,qBAAqB,CAAC,QAAQ,EAAE,qBAAqB,yBAAyB,CAAC;AAE5F,aAAa;AACb;;AAOO,eAAe,eAAe,KAAK,EAAE,YAAY,CAAC,CAAC;IACxD,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,oBAAoB;YAC/C,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,qCAAqC;YACvC;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB;gBACA;YACF;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MACR,CAAC,mBAAmB,EAAE,SAAS,MAAM,CAAC,CAAC,EAAE,SAAS,UAAU,EAAE;QAElE;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,KAAK,MAAM,EAAE;YACf,QAAQ,KAAK,CAAC,mBAAmB,KAAK,MAAM;YAC5C,MAAM,IAAI,MAAM,KAAK,MAAM,CAAC,EAAE,CAAC,OAAO;QACxC;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,MAAM;IACR;AACF"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///Users/kushagraverma/Desktop/Neural%20Pulse/Oriondiamonds/src/queries/customer.js"],"sourcesContent":["// src/queries/customer.js\nexport const CUSTOMER_CREATE = `\n  mutation customerCreate($input: CustomerCreateInput!) {\n    customerCreate(input: $input) {\n      customer {\n        id\n        email\n        firstName\n        lastName\n      }\n      customerUserErrors {\n        message\n      }\n    }\n  }\n`;\n\nexport const CUSTOMER_LOGIN = `\n  mutation customerAccessTokenCreate($input: CustomerAccessTokenCreateInput!) {\n    customerAccessTokenCreate(input: $input) {\n      customerAccessToken {\n        accessToken\n        expiresAt\n      }\n      customerUserErrors {\n        message\n      }\n    }\n  }\n`;\n\nexport const GET_CUSTOMER_INFO = `\n  query getCustomer($customerAccessToken: String!) {\n    customer(customerAccessToken: $customerAccessToken) {\n      id\n      firstName\n      lastName\n      displayName\n      email\n      phone\n      acceptsMarketing\n      createdAt\n      updatedAt\n      defaultAddress {\n        id\n        address1\n        address2\n        city\n        province\n        country\n        zip\n        firstName\n        lastName\n        phone\n      }\n      addresses(first: 10) {\n        edges {\n          node {\n            id\n            address1\n            address2\n            city\n            province\n            country\n            zip\n            firstName\n            lastName\n            phone\n          }\n        }\n      }\n      orders(first: 10) {\n        edges {\n          node {\n            id\n            orderNumber\n            processedAt\n            financialStatus\n            fulfillmentStatus\n            totalPrice {\n              amount\n              currencyCode\n            }\n            lineItems(first: 10) {\n              edges {\n                node {\n                  title\n                  quantity\n                  variant {\n                    id\n                    title\n                    image {\n                      url\n                      altText\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n`;\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;;;;AACnB,MAAM,kBAAkB,CAAC;;;;;;;;;;;;;;AAchC,CAAC;AAEM,MAAM,iBAAiB,CAAC;;;;;;;;;;;;AAY/B,CAAC;AAEM,MAAM,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyElC,CAAC"}},
    {"offset": {"line": 268, "column": 0}, "map": {"version":3,"sources":["file:///Users/kushagraverma/Desktop/Neural%20Pulse/Oriondiamonds/src/app/api/auth/%5B...nextauth%5D/route.js"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport GoogleProvider from \"next-auth/providers/google\";\nimport InstagramProvider from \"next-auth/providers/instagram\";\nimport { shopifyRequest } from \"../../../../utils/shopify\";\nimport { CUSTOMER_CREATE, CUSTOMER_LOGIN } from \"../../../../queries/customer\";\nconst handler = NextAuth({\n  providers: [\n    GoogleProvider({\n      clientId: process.env.GOOGLE_CLIENT_ID,\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n    }),\n    InstagramProvider({\n      clientId: process.env.INSTAGRAM_CLIENT_ID,\n      clientSecret: process.env.INSTAGRAM_CLIENT_SECRET,\n    }),\n  ],\n\n  callbacks: {\n    async signIn({ user, account, profile }) {\n      if (account.provider === \"google\") {\n        try {\n          // Check if customer exists in Shopify or create new one\n          const email = user.email;\n          const firstName = user.name?.split(\" \")[0] || \"User\";\n          const lastName = user.name?.split(\" \").slice(1).join(\" \") || \"\";\n\n          // Try to create customer (will fail if exists)\n          const randomPassword = Math.random().toString(36).slice(-12) + \"Aa1!\";\n\n          try {\n            await shopifyRequest(CUSTOMER_CREATE, {\n              input: {\n                email,\n                password: randomPassword,\n                firstName,\n                lastName,\n              },\n            });\n          } catch (error) {\n            // Customer might already exist, that's okay\n            console.log(\"Customer might already exist:\", error.message);\n          }\n\n          return true;\n        } catch (error) {\n          console.error(\"Error creating Shopify customer:\", error);\n          return false;\n        }\n      }\n      if (account.provider === \"instagram\") {\n        try {\n          const email = user.email || `${user.id}@instagram.com`;\n          const firstName = user.name?.split(\" \")[0] || \"Instagram\";\n          const lastName = user.name?.split(\" \").slice(1).join(\" \") || \"User\";\n\n          const randomPassword = Math.random().toString(36).slice(-12) + \"Aa1!\";\n\n          // Create Shopify customer (ignore if exists)\n          try {\n            await shopifyRequest(CUSTOMER_CREATE, {\n              input: {\n                email,\n                password: randomPassword,\n                firstName,\n                lastName,\n              },\n            });\n          } catch (err) {\n            console.log(\"Customer exists already\");\n          }\n\n          return true;\n        } catch (error) {\n          console.error(\"Instagram sign-in error:\", error);\n          return false;\n        }\n      }\n\n      return true;\n    },\n\n    async jwt({ token, account, user }) {\n      // Store user info in token\n      if (account && user) {\n        token.email = user.email;\n        token.name = user.name;\n        token.picture = user.image;\n      }\n      return token;\n    },\n\n    async session({ session, token }) {\n      // Make user info available in session\n      session.user.email = token.email;\n      session.user.name = token.name;\n      session.user.image = token.picture;\n      return session;\n    },\n  },\n\n  pages: {\n    signIn: \"/login\",\n    error: \"/login\",\n  },\n\n  debug: true, // Enable debug logs\n\n  secret: process.env.NEXTAUTH_SECRET,\n});\n\nexport { handler as GET, handler as POST };\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AACA,MAAM,UAAU,IAAA,kJAAQ,EAAC;IACvB,WAAW;QACT,IAAA,gKAAc,EAAC;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB;YACtC,cAAc,QAAQ,GAAG,CAAC,oBAAoB;QAChD;QACA,IAAA,mKAAiB,EAAC;YAChB,UAAU,QAAQ,GAAG,CAAC,mBAAmB;YACzC,cAAc,QAAQ,GAAG,CAAC,uBAAuB;QACnD;KACD;IAED,WAAW;QACT,MAAM,QAAO,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE;YACrC,IAAI,QAAQ,QAAQ,KAAK,UAAU;gBACjC,IAAI;oBACF,wDAAwD;oBACxD,MAAM,QAAQ,KAAK,KAAK;oBACxB,MAAM,YAAY,KAAK,IAAI,EAAE,MAAM,IAAI,CAAC,EAAE,IAAI;oBAC9C,MAAM,WAAW,KAAK,IAAI,EAAE,MAAM,KAAK,MAAM,GAAG,KAAK,QAAQ;oBAE7D,+CAA+C;oBAC/C,MAAM,iBAAiB,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,CAAC,MAAM;oBAE/D,IAAI;wBACF,MAAM,IAAA,2IAAc,EAAC,+IAAe,EAAE;4BACpC,OAAO;gCACL;gCACA,UAAU;gCACV;gCACA;4BACF;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,4CAA4C;wBAC5C,QAAQ,GAAG,CAAC,iCAAiC,MAAM,OAAO;oBAC5D;oBAEA,OAAO;gBACT,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,oCAAoC;oBAClD,OAAO;gBACT;YACF;YACA,IAAI,QAAQ,QAAQ,KAAK,aAAa;gBACpC,IAAI;oBACF,MAAM,QAAQ,KAAK,KAAK,IAAI,GAAG,KAAK,EAAE,CAAC,cAAc,CAAC;oBACtD,MAAM,YAAY,KAAK,IAAI,EAAE,MAAM,IAAI,CAAC,EAAE,IAAI;oBAC9C,MAAM,WAAW,KAAK,IAAI,EAAE,MAAM,KAAK,MAAM,GAAG,KAAK,QAAQ;oBAE7D,MAAM,iBAAiB,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,CAAC,MAAM;oBAE/D,6CAA6C;oBAC7C,IAAI;wBACF,MAAM,IAAA,2IAAc,EAAC,+IAAe,EAAE;4BACpC,OAAO;gCACL;gCACA,UAAU;gCACV;gCACA;4BACF;wBACF;oBACF,EAAE,OAAO,KAAK;wBACZ,QAAQ,GAAG,CAAC;oBACd;oBAEA,OAAO;gBACT,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,4BAA4B;oBAC1C,OAAO;gBACT;YACF;YAEA,OAAO;QACT;QAEA,MAAM,KAAI,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE;YAChC,2BAA2B;YAC3B,IAAI,WAAW,MAAM;gBACnB,MAAM,KAAK,GAAG,KAAK,KAAK;gBACxB,MAAM,IAAI,GAAG,KAAK,IAAI;gBACtB,MAAM,OAAO,GAAG,KAAK,KAAK;YAC5B;YACA,OAAO;QACT;QAEA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,sCAAsC;YACtC,QAAQ,IAAI,CAAC,KAAK,GAAG,MAAM,KAAK;YAChC,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAC9B,QAAQ,IAAI,CAAC,KAAK,GAAG,MAAM,OAAO;YAClC,OAAO;QACT;IACF;IAEA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IAEA,OAAO;IAEP,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC"}}]
}